# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
‚úÖ Service Worker –Ω–µ –ø—ã—Ç–∞–µ—Ç—Å—è –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å POST –∑–∞–ø—Ä–æ—Å—ã –∫ FCM
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –¢–µ—Å—Ç —Å–µ–π—á–∞—Å:

### 1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
```
Ctrl+Shift+R (hard reload)
```

### 2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫:
```
‚úÖ Firebase Messaging –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ Firebase app initialized
```

### 3. –í–∫–ª—é—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã)
- –ü—Ä–æ—Ñ–∏–ª—å ‚Üí "–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"

–ö–æ–Ω—Å–æ–ª—å –ø–æ–∫–∞–∂–µ—Ç:
```
‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–æ
üîë FCM Token –ø–æ–ª—É—á–µ–Ω: dXXXX...
‚úÖ FCM —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ...
```

### 4. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞**
1. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–∫–∞–∑ –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
2. –ê–¥–º–∏–Ω –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
3. –í –∫–æ–Ω—Å–æ–ª–∏ **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: {userId: "...", tokens: 1, payload: {...}}
‚úÖ Push –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ Cloud Function: {data: {sent: 1}}
üì© –ü–æ–ª—É—á–µ–Ω–æ FCM —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (foreground): {...}
üì¨ –î–æ–±–∞–≤–ª—è–µ–º FCM —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç: {...}
‚ûï –î–æ–±–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: {...}
üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: {total: 1, unread: 1}
```

4. **–ö–æ–ª–æ–∫–æ–ª—å—á–∏–∫ –ø–æ–∫–∞–∂–µ—Ç –∫—Ä–∞—Å–Ω—É—é —Ç–æ—á–∫—É** ‚úÖ

**–í–∞—Ä–∏–∞–Ω—Ç –ë: Background —Ç–µ—Å—Ç**
1. –í–∫–ª—é—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
2. **–ó–ê–ö–†–û–ô–¢–ï –≤–∫–ª–∞–¥–∫—É –ø–æ–ª–Ω–æ—Å—Ç—å—é**
3. –ò–∑ –¥—Ä—É–≥–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
4. **–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç –±—Ä–∞—É–∑–µ—Ä–∞** üîî

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ Service Worker

DevTools ‚Üí Application ‚Üí Service Workers

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- `service-worker.js` - activated and is running
- `firebase-messaging-sw.js` - activated and is running

### 6. –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –æ—à–∏–±–∫–∏

**–û—á–∏—Å—Ç–∏—Ç–µ –≤—Å–µ:**
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
await navigator.serviceWorker.getRegistrations().then(regs => regs.forEach(r => r.unregister()));
localStorage.clear();
location.reload();
```

–ó–∞—Ç–µ–º –∑–∞–Ω–æ–≤–æ:
1. –í–∫–ª—é—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è
3. –°–æ–∑–¥–∞–π—Ç–µ —Å–æ–±—ã—Ç–∏–µ

---

## –ß—Ç–æ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:

‚úÖ Service Worker —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
‚úÖ FCM —Ç–æ–∫–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Firestore
‚úÖ Foreground —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
‚úÖ –ö—Ä–∞—Å–Ω–∞—è —Ç–æ—á–∫–∞ –Ω–∞ –∫–æ–ª–æ–∫–æ–ª—å—á–∏–∫–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è
‚úÖ Background —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–æ–≥–¥–∞ –≤–∫–ª–∞–¥–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞
‚úÖ Cloud Functions –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —á–µ—Ä–µ–∑ Firebase Admin SDK

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí —Å–º–æ—Ç—Ä–∏—Ç–µ `docs/PUSH_NOTIFICATIONS_DEBUG.md`
